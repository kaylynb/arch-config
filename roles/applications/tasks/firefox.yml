---
- name: install firefox package
  become: true
  package:
    name: firefox
    state: present

- name: install user firefox configuration directories
  file:
    path: ~/.mozilla/firefox/profile
    state: directory
    recurse: true
    mode: 0700

- name: install user firefox profiles configuration
  copy:
    src: firefox/profiles.ini
    dest: ~/.mozilla/firefox/
    mode: 0644

- name: generate user.js file content
  script: firefox/generate-user.js.sh
  register: firefox_user_js
  changed_when: false

- name: install user.js file
  copy:
    content: "{{ firefox_user_js.stdout }}"
    dest: ~/.mozilla/firefox/profile/user.js
    mode: 0644
  notify:
    - restart systemd-timesyncd service
